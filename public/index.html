<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>ğŸ¤2äººã®ç›¸æ€§è¨ºæ–­ğŸ¤</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

</head>

<body>


  <body>
    <div class="container-sm">
      <div class="row">
        <div class="col">
          <div class="card" style="background-color:white;" >
            <div class="card-body">
              <h1 style="text-align: center; font-size: 40px; color:black;">ğŸ¤2äººã®ç›¸æ€§è¨ºæ–­ğŸ¤</h1>
              <p id="hosi" style="font-size: 30px;">ç›¸æ€§ï¼š0</p>
              <p id="message" hidden></p>
              <p id="messages" style="text-align: center; font-size: 20px; color: black;"></p>
              <button class="btn btn-danger" id="webcamButton" disabled style="text-align: center;">
                ã‚«ãƒ¡ãƒ©ã‚’èµ·å‹•ğŸ“·
              </button>
              <div style="position: relative;">
                <video id="webcam" style="position:absolute;left:0px;top:0px;width:100%;height:auto" autoplay
                  playsinline></video>
                <div id="canvas" style="position:absolute;left:0px;top:0px">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>



    <script src="/socket.io/socket.io.js"></script>
    <script>
          const startMessages = [
      "å¤ã¨ã„ãˆã°ï¼Ÿ æµ·:âœŠ ãŠç¥­ã‚Š:âœŒï¸ èŠ±ç«:âœ‹",
      "å¤ç¥­ã‚Šã¨ã„ãˆã°ï¼Ÿ ã‹ãæ°·:âœŠ ã‚Šã‚“ã”ã‚ã‚:âœŒï¸ ç„¼ããã°:âœ‹",
      "å¯æ„›ã„å‹•ç‰©ã¨ã„ãˆã°ï¼Ÿ çŠ¬:âœŠ ã­ã“:âœŒï¸ ã†ã•ã:âœ‹",
      "ãŠå¯¿å¸ã¨ã„ãˆã°ï¼Ÿ ãƒã‚°ãƒ­:âœŠ ã‚µãƒ¼ãƒ¢ãƒ³:âœŒï¸ ãˆã³:âœ‹",
    ];

    let currentMessageIndex = 0; // ç¾åœ¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
    let hosi_count = 0; // ã‚«ã‚¦ãƒ³ãƒˆå¤‰æ•°ã‚’åˆæœŸåŒ–

    function getNextMessage() {
      const message = startMessages[currentMessageIndex];
      currentMessageIndex = (currentMessageIndex + 1) % startMessages.length; // æ¬¡ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç§»å‹•
      return message;
    }
    function getRandomMessage() {
      const randomIndex = Math.floor(Math.random() * startMessages.length);
      return startMessages[randomIndex];
    }

      let result_message = "";
      const socket = io();
      socket.on('leaved', () => {
        document.getElementById('messages').innerText = "ç›¸æ‰‹ãŒã„ã¾ã›ã‚“";
        mode = 0;
      });
      socket.on('new_challenger', (message) => {
        document.getElementById('messages').innerText = "ã‚«ãƒ¡ãƒ©ã‚’èµ·å‹•ã—ã¦ğŸ¤Ÿã‚’ã—ã¦ã­ï¼";
        mode = 1;
      });
      socket.on('you_are_challenger', (message) => {
        document.getElementById('messages').innerText = "ã‚«ãƒ¡ãƒ©ã‚’èµ·å‹•ã—ã¦ğŸ¤Ÿã‚’ã—ã¦ã­ï¼";
        mode = 1;
      });
      socket.on('start', (message) => {
        document.getElementById('messages').innerText = getNextMessage();
        count.play();
        mode = 3;
      });
      socket.on('result', (data) => {
        kirakira.play();
        console.log(data);
        mode = 1;
        let te = {
          me: 0,
          you: 0
        };
        for (d of data) {
          if (d.id != socket.id) {
            te.you = d.janken_type;
          }
          else {
            te.me = d.janken_type;
          }
        }
        if (te.me == te.you) {
        result_message = "ç›¸æ€§ãƒãƒƒãƒãƒªğŸ¤";
        hosi_count = (hosi_count || 0) + 1; // ã‚«ã‚¦ãƒ³ãƒˆã‚’å¢—ã‚„ã™ï¼ˆNaNãƒã‚§ãƒƒã‚¯ï¼‰
        document.getElementById('hosi').innerText = `ç›¸æ€§ï¼š${'ğŸŒŸ'.repeat(hosi_count)}`; // ã‚«ã‚¦ãƒ³ãƒˆåˆ†ã ã‘æ˜Ÿã‚’è¡¨ç¤º
      } else {
        result_message = "ç›¸æ€§æ®‹å¿µğŸ˜¢";
      }
      
        setTimeout(() => {
          document.getElementById('messages').innerText = "";
          result_message = "";
        }, 10000);
      });
    </script>


    <!-- include js libraries -->
    <script src="./js/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="./js/hands.js" crossorigin="anonymous"></script>
    <script src="./js/p5.js"></script>
    <script src="./js/p5.sound.js"></script>
    <script src="./js/sketch.js"></script>
    <script type="module" src="./js/script.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"></script>

  </body>

</html>

<style>
  body {
    font-family: sans-serif;
    background-color: pink;
  }
 
</style>